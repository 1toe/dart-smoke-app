# üì¶ GU√çA COMPLETA: COMPILAR APK DE SMOKETRACKER

**√öltima actualizaci√≥n**: 16 de Octubre de 2025

---

## üéØ ¬øQU√â ES UN APK?

Un **APK** (Android Package Kit) es el archivo ejecutable de Android. Es lo que instalas en tu tel√©fono/tablet desde Google Play Store o directamente.

---

## üìã REQUISITOS PREVIOS

Antes de compilar, aseg√∫rate de tener:

```
‚úÖ Flutter SDK instalado
‚úÖ Android SDK instalado
‚úÖ Android Build Tools
‚úÖ Java Development Kit (JDK) 11 o superior
‚úÖ Emulador o dispositivo Android
```

**Verifica que todo est√© bien:**
```bash
flutter doctor
```

Deber√≠a mostrar: `Android toolchain - develop for Android devices [‚úì]`

---

## üöÄ COMPILAR APK EN 5 PASOS

### PASO 1: Abre Terminal/PowerShell

```powershell
cd c:\Users\toe\Desktop\dartOficial
```

### PASO 2: Limpia Build Anterior (Recomendado)

```bash
flutter clean
flutter pub get
```

### PASO 3: OPCI√ìN A - BUILD EN MODO DEBUG (M√°s R√°pido)

```bash
flutter build apk --debug
```

**Tiempo**: 3-5 minutos  
**Tama√±o**: ~50 MB  
**Uso**: Pruebas locales

### PASO 3: OPCI√ìN B - BUILD EN MODO RELEASE (Recomendado para Producci√≥n)

```bash
flutter build apk --release
```

**Tiempo**: 5-10 minutos  
**Tama√±o**: ~20 MB  
**Uso**: Desplegar en Google Play Store

---

## üìç D√ìNDE ENCUENTRA EL APK

Despu√©s de compilar exitosamente, el APK estar√° en:

**Debug:**
```
c:\Users\toe\Desktop\dartOficial\build\app\outputs\flutter-apk\app-debug.apk
```

**Release:**
```
c:\Users\toe\Desktop\dartOficial\build\app\outputs\flutter-apk\app-release.apk
```

---

## üì± INSTALAR APK EN DISPOSITIVO

### Opci√≥n A: Instalaci√≥n Autom√°tica (Recomendado)

Despu√©s del build, ejecuta:

```bash
flutter install
```

Flutter detectar√° el APK compilado e instalar√° autom√°ticamente en tu dispositivo/emulador.

### Opci√≥n B: Instalaci√≥n Manual

```bash
# Listar dispositivos disponibles
flutter devices

# Instalar en dispositivo espec√≠fico
adb install -r build/app/outputs/flutter-apk/app-release.apk
```

### Opci√≥n C: Copiar y Abrir Manualmente

1. Ve a la carpeta del APK
2. Copia `app-release.apk` a tu computadora/tel√©fono
3. Abre en tu tel√©fono Android
4. Acepta instalar desde fuente desconocida si es necesario

---

## ‚öôÔ∏è CONFIGURACI√ìN ANTES DE BUILD (Importante)

### Paso 1: Configura android/app/build.gradle

Abre: `android/app/build.gradle`

Verifica estas secciones:

```gradle
android {
    compileSdkVersion 34  // O la versi√≥n actual
    
    defaultConfig {
        applicationId "com.example.smoketracker"  // Cambiar esto
        minSdkVersion 21
        targetSdkVersion 34
        versionCode 1
        versionName "1.0.0"
    }
    
    buildTypes {
        release {
            signingConfig signingConfigs.release
        }
    }
}
```

### Paso 2: Configura Firma Digital (Para Release)

Crea un archivo de configuraci√≥n de firma. Ve a: `android/app/build.gradle`

Busca la secci√≥n `signingConfigs` y aseg√∫rate de que est√© configurada o agrega:

```gradle
signingConfigs {
    release {
        keyAlias "smoketracker"
        keyPassword "tu_contrase√±a"
        storeFile file("release.keystore")
        storePassword "tu_contrase√±a"
    }
}
```

**Para generar el keystore (solo una vez):**

```bash
keytool -genkey -v -keystore release.keystore -keyalg RSA -keysize 2048 -validity 10000 -alias smoketracker
```

Este comando:
- Genera un archivo `release.keystore` en `android/app/`
- Te pide informaci√≥n (Pa√≠s, Ciudad, Empresa, etc.)
- Usa ese keystore para firmar futuros APK

---

## üìä TIPOS DE BUILD

### DEBUG APK
```bash
flutter build apk --debug
```
- **Tama√±o**: M√°s grande (~50 MB)
- **Velocidad**: M√°s r√°pido de compilar
- **Uso**: Desarrollo y pruebas
- **Firma**: No requiere configuraci√≥n adicional
- **Instalaci√≥n**: R√°pida

### RELEASE APK
```bash
flutter build apk --release
```
- **Tama√±o**: M√°s peque√±o (~20 MB)
- **Velocidad**: M√°s lento de compilar (optimizaci√≥n)
- **Uso**: Producci√≥n, Google Play Store
- **Firma**: Requiere keystore
- **Instalaci√≥n**: M√°s segura

### SPLIT APK (M√∫ltiples arquitecturas)
```bash
flutter build apk --split-per-abi --release
```

Genera 3 APK separados:
- `app-armeabi-v7a-release.apk` (32-bit)
- `app-arm64-v8a-release.apk` (64-bit)
- `app-x86_64-release.apk` (Emulador)

---

## üîç SOLUCI√ìN DE PROBLEMAS

### Problema 1: "Build Gradle antiguo"

**Error:**
```
Your app is using an unsupported Gradle project
```

**Soluci√≥n:**
```bash
flutter clean
cd android
./gradlew clean
cd ..
flutter pub get
flutter build apk --release
```

### Problema 2: "Java version too old"

**Error:**
```
The Java version is too old
```

**Soluci√≥n:**
1. Instala Java 11 o superior
2. Verifica: `java -version`
3. Si no aparece, agrega al PATH la ruta de Java

### Problema 3: "Insufficient disk space"

**Soluci√≥n:**
```bash
flutter clean
```

Esto elimina archivos temporales de build (libera ~500 MB)

### Problema 4: "SDK version not compatible"

**Soluci√≥n:**
Abre `android/app/build.gradle` y actualiza:
```gradle
compileSdkVersion 34
targetSdkVersion 34
```

### Problema 5: "APK no se instala"

**Soluci√≥n:**
```bash
adb uninstall com.example.smoketracker
flutter install
```

---

## üìà COMPARATIVA: DEBUG vs RELEASE

| Caracter√≠stica | DEBUG | RELEASE |
|---|---|---|
| Tama√±o | 50-60 MB | 15-25 MB |
| Tiempo | 3-5 min | 8-15 min |
| Optimizaci√≥n | No | S√≠ (tree-shaking, minificaci√≥n) |
| Debugging | S√≠ | No |
| Performance | Lenta | R√°pida |
| Producci√≥n | ‚ùå No | ‚úÖ S√≠ |

---

## üéØ GU√çA R√ÅPIDA: BUILD EN 3 PASOS

```bash
# Paso 1: Limpia
flutter clean

# Paso 2: Compila
flutter build apk --release

# Paso 3: Instala
flutter install
```

¬°Listo! La app se instalar√° en tu dispositivo.

---

## üì± INSTALAR EN M√öLTIPLES DISPOSITIVOS

```bash
# Ver dispositivos
flutter devices

# Instalar en dispositivo espec√≠fico
flutter install -d <device-id>
```

---

## üöÄ SUBIR A GOOGLE PLAY STORE (Pr√≥ximos pasos)

Una vez compilado el APK release, puedes subirlo a Google Play Store:

1. **Crea cuenta de Google Play Developer** (~$25 √∫nico)
2. **Genera un App Bundle** en lugar de APK:
   ```bash
   flutter build appbundle --release
   ```
3. **Sube el bundle** a Google Play Console
4. **Completa metadatos** (descripci√≥n, screenshots, etc.)
5. **Publica la app**

Esto har√° que la app est√© disponible en Google Play Store.

---

## üì∏ VERIFICAR QUE EL APK FUNCIONA

Despu√©s de instalar:

1. Abre Settings en tu tel√©fono
2. Ve a Apps ‚Üí SmokeTracker
3. Verifica que est√° instalada
4. Abre la app y prueba funcionalidades

---

## üíæ GUARDAR APK PARA DISTRIBUCI√ìN

Si quieres guardar el APK compilado:

```bash
# Crear carpeta de salida
mkdir c:\Users\toe\Desktop\SmokeTracker_APK

# Copiar APK compilado
copy build\app\outputs\flutter-apk\app-release.apk c:\Users\toe\Desktop\SmokeTracker_APK\
```

Ahora puedes:
- Compartir el APK por email
- Subirlo a un servidor
- Enviarlo a testers
- Distribuirlo manualmente

---

## üìù CHECKLIST ANTES DE BUILD FINAL

- [ ] Actualizaste `versionCode` y `versionName` en build.gradle
- [ ] Ejecutaste `flutter analyze` (0 issues)
- [ ] Ejecutaste `flutter test` si tienes tests
- [ ] Probaste la app en emulador
- [ ] Configuraste firma digital (para release)
- [ ] Tienes espacio en disco (~2 GB)
- [ ] Java est√° instalado (flutter doctor ok)

---

## üéì COMANDOS REFERENCIA

```bash
# Build b√°sicos
flutter build apk                    # Debug autom√°tico
flutter build apk --debug            # Debug expl√≠cito
flutter build apk --release          # Release

# Build avanzados
flutter build apk --split-per-abi --release  # M√∫ltiples arquitecturas
flutter build appbundle --release    # Para Google Play Store

# Instalar
flutter install                      # Instalar en dispositivo por defecto
flutter install -d <device-id>      # Instalar en dispositivo espec√≠fico

# Utilidades
flutter devices                      # Ver dispositivos
flutter doctor                       # Revisar setup
flutter clean                        # Limpiar cache
adb uninstall <package-name>        # Desinstalar app
adb logcat                          # Ver logs del dispositivo
```

---

## üîê SEGURIDAD: PROTEGE TU KEYSTORE

‚ö†Ô∏è **IMPORTANTE**: Tu archivo `release.keystore` es como una contrase√±a maestra. 

**NUNCA compartas:**
- El archivo `release.keystore`
- La contrase√±a del keystore
- La contrase√±a del alias

**SIEMPRE guarda:**
- Una copia de seguridad del keystore en lugar seguro
- La contrase√±a en lugar seguro (gestor de contrase√±as)

Si pierdes el keystore, NO PODR√ÅS actualizar tu app en Google Play Store.

---

## üìä MONITOREO POST-INSTALACI√ìN

Despu√©s de instalar, puedes:

```bash
# Ver logs en tiempo real
flutter logs

# Ver estado de la app
adb shell pm dump com.example.smoketracker
```

---

## ‚úÖ RESUMEN

| Paso | Comando | Tiempo |
|------|---------|--------|
| 1. Limpia | `flutter clean` | 30 seg |
| 2. Descarga | `flutter pub get` | 1 min |
| 3. Compila | `flutter build apk --release` | 10 min |
| 4. Instala | `flutter install` | 2 min |
| **TOTAL** | | **~13 min** |

---

## üéØ PR√ìXIMOS PASOS

1. ‚úÖ Compila tu primer APK con `flutter build apk --release`
2. üß™ Instala y prueba en tu dispositivo
3. üì∏ Toma screenshots para Google Play
4. üìù Prepara descripci√≥n y detalles de la app
5. üöÄ (Opcional) Sube a Google Play Store

---

## üÜò NECESITAS AYUDA

Si hay errores durante la compilaci√≥n:

1. Ejecuta `flutter doctor` y arregla los problemas que muestre
2. Consulta `SETUP.md` en el proyecto (secci√≥n troubleshooting)
3. Busca el error en Google (usualmente hay soluci√≥n)
4. Intenta `flutter clean && flutter pub get`

---

## üìû REFERENCIA R√ÅPIDA

**BUILD DEBUG** (R√°pido, para pruebas):
```bash
flutter build apk --debug && flutter install
```

**BUILD RELEASE** (Lento, para producci√≥n):
```bash
flutter build apk --release && flutter install
```

**BUILD M√öLTIPLE** (Para Google Play):
```bash
flutter build appbundle --release
```

---

**¬°Listo para compilar tu APK! üöÄ**

Si completaste estos pasos, tu app SmokeTracker ya est√° lista en tu dispositivo Android.

Disfruta distribuyendo tu aplicaci√≥n. üéâ
